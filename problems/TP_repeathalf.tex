\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{TP_repeathalf}
  \pcomment{variation of TP_infinite_repeat}
  \pcomment{by ARM 12/13/13}
\end{pcomments}

\pkeywords{
  expectation
  failure
  infinite
  geometric_series
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
You have a biased coin with nonzero probability $p<1$ of tossing a
Head.  You toss until a Head comes up and record the number of Tails
that preceded this first Head.  Then\inbook{, similar to the example
  in Section~\bref{infinite_expect_sec},} you keep tossing until you
get another Head preceded by at least half as many consecutive Tails.
Prove that the expected number of Heads you toss is finite.

\begin{solution}
Let the random variable $T$ be the length of your initial run of
tails.  Suppose $T$ takes the value $k$, that is, you flip $k$
consecutive Tails followed by a Head.  Then you try flipping
until you get another Head.  If the number of consecutive Tails before
the last Head is $< k/2$, you try the same thing again.

The probability that one \textbf{try} will result in $\geq k/2$ Tails
is $q^{\ceil{k/2}}$, where $q \eqdef 1-p$.  So thinking of finally
flipping enough Tails as a ``failure,'' the expected number of tries
is the mean time to failure, namely, $1/q^{\ceil{k/2}}$.

Letting $H$ be the number of Heads that appear at the end of a try, we
have
\begin{align*}
\expect{H}
    & = \sum_{k \in \naturals} \expcond{H}{T=k} \cdot \prob{T=k}\\
    & = \sum_{k \in \naturals} \frac{1}{q^{\ceil{k/2}}} \cdot q^k p\\
    & \leq \sum_{k \in \naturals} \frac{1}{q^{k/2}} \cdot q^k p\\
    & = p \sum_{k \in \naturals}  q^{k/2}\\
    & = p\sum_{k \in \naturals} \paren{\sqrt{q}}^k \\
    & = \frac{p}{1- \sqrt{q}} < \infty.
\end{align*}
\end{solution}

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
 
