\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_Stirlings_and_log_n_factorial}
  \pcomment{from: S09.cp9t}
  \pcomment{from: F03.ps6}
\end{pcomments}

\pkeywords{
  asymptotics
  Stirlings_formula
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
\bparts

\ppart Give an elementary proof (without appealing to Stirling's formula)
that $\log (n!) = \Theta(n\log n)$.

\begin{solution}
An elementary proof goes as follows:

First,
\begin{align*}
\log (n!) &= \sum_{i=1}^n \log i\\
&< \sum_{i=1}^n \log n\\
&=n\log n. 
\end{align*}

On the other hand, 
\begin{align*}
\log (n!) &= \sum_{i=1}^n \log i\\
 & > \sum_{i=\ceil{(n+1)/2}}^n \log i\\
    & > \sum_{i=\ceil{(n+1)/2}}^n \log (n/2)\\
    & > \frac{n}{2} \cdot \log (n/2)\\
    & = \frac{n ((\log n) -1)}{2}\\
    & = \frac{n \log n}{2} - \frac{n}{2}\\
    & > \frac{n \log n}{2} -\frac{n \log n}{6} & \text{for $n>8$.}\\
    & = \frac{1}{3} \cdot n \log n.
\end{align*}

Therefore, $(1/3)n \log n < \log(n!) <n\log n$ for $n>8$, proving that
$\log(n!)=\Theta(n\log n)$.
\end{solution}

\ppart Use Stirling's formula to prove that in fact
\[
\log (n!) \sim n \log n
\]
\hint $f \sim g$ for $f,g \geq 1$ implies $\log f \sim \log g$.

\begin{solution}
Taking logs of both sides of Stirling's formula and using the hint, we
  have
\begin{align*}
\log (n!)
& \sim n \log\paren{\frac{n}{e}} + \log \sqrt{2 \pi n}\\
& = n \log n - n \log e + \log \sqrt{2 \pi n}\\
& \sim n \log n.
\end{align*}

The final step follows from the fact that
\begin{align*}
\lim_{n \to \infty} \frac{n \log n - n \log e + \log \sqrt{2 \pi n}}{n \log n} & =
\lim_{n \to \infty} \paren{\frac{n \log n}{n \log n} - \frac{n \log e}{n \log n}
+ \frac{\log \sqrt{2 \pi n}}{n \log n}}\\
& = 1 - \lim_{n \to \infty} \frac{\log e}{\log n} + \lim_{n \to \infty}
\frac{\log \sqrt{2 \pi n}}{n \log n}\\
& = 1 - 0 - 0 = 1.
\end{align*}

\end{solution}

\eparts
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
