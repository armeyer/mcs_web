\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{MQ_gen_2}
  \pcomment{shortened from recurrence in FP_linear_recur}
  \pcomment{ARM 4.28.12}
\end{pcomments}

\pkeywords{
  recurrence
  linear_recurrence
  generating_function
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Define the sequence $r_0, r_1, r_2, \dots$ recursively by the
rule that $r_0 \eqdef 0$ and
\[
     r_n \eqdef 7r_{n-1} + (n+1), \qquad \text{for } n > 0.
\]

Let $R(x) \eqdef \sum_0^\infty r_n x^n$ be the generating function of
this sequence.  Express $R(x)$ as a quotient of polynomials or
products of polynomials.  You do \emph{not} have to find a closed form
for $r_n$.

\begin{solution}
We have
\[
\begin{array}{rcrcrcrcrcr}
R(x)       & = & r_0 & + &  r_1 x & + \cdots  + &    r_nx^n & + \cdots\\
-7xR(x)    & = &     & - & 7r_0 x & - \cdots - & 7r_{n-1}x^n & - \cdots\\
-1/(1-x)^2 & = & - 1 & - &    2 x & - \cdots - &   (n+1)x^n & - \cdots\\
\hline
\lefteqn{R(x)(1-7x) - 1/(1-x)^2}\\
         & = & (r_0-1) & + &  0 x & + \cdots + &      0x^n & + \cdots\\
         & = & -1.
\end{array}
\]
so
\[
R(x) = \frac{1}{(1-7x)(1-x)^2} - \frac{1}{1-7x}\ .
\]
This can be further simplified to
\[
R(x) = \frac{x(2-x)}{(1-x)^2(1-7x)}\ .
\]

\end{solution}

\end{problem}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\endinput
