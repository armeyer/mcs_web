!%PS_butterfly_congestion

\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_butterfly_congestion}
  \pcomment{from: S09 network notesproblem}
  \pcomment{variant in S09.ps7}
  \pcomment{commented out in S09 - looks like it needs substantial
    revision}
\end{pcomments}

\pkeywords{
  networks
  congestion
  butterfly
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
  Show that the \idx{congestion} of the \idx{butterfly net}, $F_n$, is
  exactly $\sqrt{N}$ when $n$ is even.

\hint
\begin{itemize}
\item There is a unique path from each input to each output, so the
  congestion is the maximum number of messages passing through a vertex
  for any routing problem.
\item If $v$ is a vertex in column  $i$ of the butterfly
network, there is a path from exactly $2^i$ input vertices to $v$
and a path from $v$ to exactly $2^{n-i}$ output vertices.\\
\item At which column of the butterfly network must the congestion be
  worst?  What is the congestion of the topmost switch in that column of
  the network?
\end{itemize}

\begin{solution}

First we will show that the congestion is at most $\sqrt{N}$.

Let $v$ be an arbitrary vertex in some column $i$. Let $S_v$ be the set of
inputs that can reach vertex $v$. Let $T_v$ be the set of outputs that are
reachable from vertex $v$.

By the hint, we have $\card{S_v} = 2^i$ and $\card{T_v} = 2^{n-i}$.
(This can be proved by induction on $n$, but we'll skip the proof.)
The number of inputs in $S_v$ that are matched with outputs in $T_v$
is at most $\min \set{2^i,2^{n-i}}$.  To obtain an upper-bound on
the congestion of the network, we need to find the maximum value of
$\min \set{2^i,2^{n-i}}$, where the maximum is taken over all $i$.
The maximum value is achieved when $2^i$ and $2^{n-i}$ are as equal
as possible. Since $n$ is even, these two quantities are equal when
$i=n/2$, hence the congestion is at most
\[
2^{n/2}=N^{1/2} = \sqrt{N}.
\]

Now we need to show that the congestion achieves $\sqrt{N}$ somewhere in
the network.  We concluded that the congestion of $\sqrt{N}$ can be
achieved only at a node in column $\frac{n}{2}$.  Consider the node at the
top of this column.  A packet from an input $i$ where $i$ has a binary
representation in the form $z\underbrace{0\ldots 000}_{n/2\ bits}$ with
destination $\underbrace{000\ldots0}_{n/2\ bits}z'$, where $z$ and $z'$
are any $\frac{n}{2}$-bit numbers, must pass through this node. But there
are $2^{n/2}=\sqrt{N}$ of them, giving the node load $\sqrt{N}$.
Therefore, we can conclude that the congestion of $B_n$ is exactly
$\sqrt{N}$ when $n$ is even.

%In fact, the set of vertices with load $\sqrt{N}$ are those vertices
%$v$ at level $\frac{n}{2}$ with the last $\frac{n}{2}$ bits being
%the reversal of its first $\frac{n}{2}$ bits.
%
%As a sanity check, there are a total of $\sqrt{N}\ n$-bit numbers in
%the form $kk^r$. So there are $\sqrt{N}$ vertices at level
%$\frac{n}{2}$ with load $\sqrt{N}$, giving us a total of $N$
%packets.

\end{solution}
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
