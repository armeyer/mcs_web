\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_gen_fcn_quotient_polynomials}
  \pcomment{from: S09.cp12t}
\end{pcomments}

\pkeywords{
  generating_functions
  derivative
  rational_function
  linear_recurrence
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Taking derivatives of generating functions is another useful operation.
This is done termwise, that is, if
\[
F(x) = f_0 +f_1 x+ f_2 x^2 + f_3 x^3 + \cdots,
\]
then
\[
F'(x) \eqdef f_1 + 2 f_2 x + 3 f_3 x^2 + \cdots.
\]
For example,
\[
\frac{1}{(1-x)^2} = \paren{\frac{1}{(1-x)}}' = 1 +2x +3x^2+\cdots
\]
so
\[
H(x) \eqdef \frac{x}{(1-x)^2} = 0+ 1x +2x^2 +3x^3 + \cdots
\]
is the generating function for the sequence of nonnegative integers.
Therefore
\[
\frac{1+x}{(1-x)^3} = H'(x) = 1 + 2^2x + 3^2x^2 + 4^2x^3 + \cdots,
\]
so
\[
\frac{x^2+ x}{(1-x)^3} = xH'(x) = 0 + 1x + 2^2x^2 + 3^2x^3 + \cdots + n^2x^n + \cdots
\]
is the generating function for the nonnegative integer squares.

\bparts

\ppart\label{rkxskx} Prove that for all $k \in \naturals$, the generating
function for the nonnegative integer $k$th powers is a quotient of
polynomials in $x$.  That is, for all $k \in \naturals$ there are
polynomials $R_k(x)$ and $S_k(x)$ such that
\begin{equation}\label{nk}
[x^n]\paren{\frac{R_k(x)}{S_k(x)}} = n^k.
\end{equation}

\hint Observe that the derivative of a quotient of polynomials is also a
quotient of polynomials.  It is not necessary work out explicit formulas
for $R_k$ and $S_k$ to prove this part.

\begin{solution}
The proof is by induction on $k$ with the hypothesis that there are
polynomials $R_k(x)$ and $S_k(x)$ satisfying~\eqref{nk}.

\textbf{base case $k=0$}: Let $R_0(x) \eqdef 1$, $S_0(x) \eqdef (1-x)$.

\textbf{inductive step}: Assuming by induction that we have $R_k,S_k$
satisfying~\eqref{nk} the generating function for the $k+1$st powers will
be
\begin{equation}\label{RSk}
x\paren{\frac{R_k(x)}{S_k(x)}}' =  \frac{x{R_k}'}{S_k} - \frac{xR_k}{\paren{{S_k}'}}
\end{equation}
But the derivative of a polynomial is (obviously) a polynomial, so the
right hand side of~\eqref{RSk} is a sum of quotients of polynomials, which
can always be simplified into a quotient of two polynomials.  Let $R_{k+1}$
and $S_{k+1}$ be these two polynomials.
\end{solution}

\iffalse
\ppart Prove that for any complex number, $\alpha$, and polynomial,
$p(n)$, with complex coefficients, the generating function
\[
p(0) + p(1)\alpha + p(2)\alpha^2 + \cdots + p(n)\alpha^n + \cdots
\]
is a quotient of polynomials in $x$.
\fi

\ppart Conclude that if $f(n)$ is a function on the nonnegative integers
defined recursively in the form
\[
f(n)  = a f(n-1) + b f(n-2) + c f(n-3) + p(n)\alpha^n
\]
where the $a, b, c, \alpha \in \complexes$ and $p$ is a
polynomial with complex coefficients, then the generating function for
the sequence $f(0),f(1),f(2),\dots$ will be a quotient of polynomials in
$x$, and hence there is a closed form expression for $f(n)$.

\hint Consider \[
\frac{R_k(\alpha x)}{S_k(\alpha x)}
\]

\begin{solution}
By part~\eqref{rkxskx}, $R_k(\alpha x))/S_k(\alpha x)$ is the generating
function for the sequence whose $n$th term is $n^k\alpha^n$.  So for any
function of $n$ of the form $p(n)\alpha^n$, a linear combination of
such expressions $R_k/S_k$ for $k=0,1,\dots, \text{degree}(p)$
will yield a quotient, $Q(x)$, of polynomials that is a generating function,
for $p(n)\alpha^n$, that is $[x^n]Q(x) = p(n)\alpha^n$.

Letting $F(x)$ be the generating function with $[x^n]F(x) = f(n)$, the
usual argument shows that
\begin{align*}
\lefteqn{F(x) -axF(x) -bx^2F(x)-cx^3 F(x) - Q(x)}\\
& = f(0)-Q(0) + (f(1)-af(0)-Q(1))x + (f(2) - af(1) -bf(0) - Q(2))x^2,
\end{align*}
allowing a solution for $F(x)$ as a quotient of polynomials.  Thus in turn
implies that $f(n)$ is a linear combination of terms of the form $\gamma^n
n^k$ for constants $\gamma \in \complexes$ and $k \in \naturals$.

\end{solution}

\eparts
\end{problem}

\endinput
