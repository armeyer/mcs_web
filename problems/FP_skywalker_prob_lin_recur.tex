\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_skywalker_prob_lin_recur}
  \pcomment{final.S05}
\end{pcomments}

\pkeywords{
  linear_recurrence
  probability
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Every Skywalker serves either the \textit{light side} or the
\textit{dark side}.
%
\begin{itemize}
\item The first Skywalker serves the dark side.
\item For $n \geq 2$, the $n$-th Skywalker serves the same side as the
$(n-1)$-st Skywalker with probability $1/4$, and the opposite side
with probability $3/4$.
\end{itemize}
%
Let $d_n$ be the probability that the $n$-th Skywalker serves the dark
side.

\bparts

\ppart Express $d_n$ with a recurrence equation and sufficient base
cases.

\begin{solution}
\begin{align*}
d_1
    & = 1 \\
d_{n+1}
    & = \frac{1}{4} \cdot d_n + \frac{3}{4} \cdot (1 - d_n) \\
    & = \frac{3}{4} - \frac{1}{2} d_n
\end{align*}

\end{solution}

\ppart Give a closed-form expression for $d_n$.

\begin{solution}
The characteristic equation is $x - 1/2 = 0$.  The only root
is $x = - 1/2$.  Therefore, the homogenous solution has the form $d_n
= A \cdot (-1/2)^n$.  For a particular solution, we first guess $d_n =
c$.  This is indeed a solution for $c = 1/2$.  Therefore, the complete
solution has the form $d_n = 1/2 + A \cdot (-1/2)^n$.  Since $d_1 =
1$, we must have $A = -1/2$.  Therefore:
%
\[
d_n = \frac{1}{2} + \paren{- \frac{1}{2}}^{n+1}
\]

\end{solution}

\begin{editingnotes}\textbf{PROBABLY CUT}\end{editingnotes}

\ppart If two consecutive Skywalkers serve opposite sides, they have a
lightsaber duel.  What is the expected number of lightsaber duels
among the first $n$ Skywalkers?

\begin{solution}
There is a duel between two consecutive Skywalkers with
probability $3/4$ and there are $n-1$ pairs of consecutive Skywalkers,
so the expected number of duels is $3(n-1)/4$.
\end{solution}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
