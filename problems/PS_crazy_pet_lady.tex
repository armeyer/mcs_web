\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_crazy_pet_lady}
  \pcomment{from: S09.ps10, F11, S13.ps11}
\end{pcomments}

\pkeywords{
  generating_functions
  partial_fractions
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}

Miss McGillicuddy never goes outside without a collection of pets.  In
particular:

\begin{itemize}
\item She brings a positive number of songbirds, which always come in
pairs.

\item She may or may not bring her alligator, Freddy.

\item She brings at least 2 cats.

\item She brings two or more chihuahuas and labradors leashed together in a
line.
\end{itemize}

Let $P_n$ denote the number of different collections of $n$ pets that
can accompany her, where we regard chihuahuas and labradors leashed up
in different orders as different collections, even if there are the same
number chihuahuas and labradors leashed in the line.

For example, $P_6 = 4$ since there are 4 possible collections of 6 pets:
\begin{itemize}
\item 2 songbirds, 2 cats, 2 chihuahuas leashed in line
\item 2 songbirds, 2 cats, 2 labradors leashed in line
\item 2 songbirds, 2 cats, a labrador leashed behind a chihuahua
\item 2 songbirds, 2 cats, a chihuahua leashed behind a labrador
\end{itemize}
And $P_7 = 16$ since there are 16 possible collections of 7 pets:
\begin{itemize}
\item 2 songbirds, 3 cats, 2 chihuahuas leashed in line
\item 2 songbirds, 3 cats, 2 labradors leashed in line
\item 2 songbirds, 3 cats, a labrador leashed behind a chihuahua
\item 2 songbirds, 3 cats, a chihuahua leashed behind a labrador
\item 4 collections consisting of 2 songbirds, 2 cats, 1 alligator, and a
line of 2 dogs
\item 8 collections consisting of 2 songbirds, 2 cats, and a line of 3 dogs.
\end{itemize}

\bparts

\ppart Let
\[
P(x) \eqdef P_0 + P_1 x + P_2 x^2 + P_3 x^3 + \cdots
\]
be the generating function for the number of Miss
McGillicuddy's pet collections.  Verify that
\[
P(x) = \frac{4x^6}{(1-x)^2(1-2x)}.
\]

\begin{solution}
\begin{align*}
P(x) & = \underbrace{(x^2 + x^4 + x^6 + x^8 +
\cdots)}_{\text{collections of songbirds}}\\
     & \cdot \underbrace{(1 + x)}_{\text{collections of gators}}\\
     &\ \cdot \underbrace{(x^2 + x^3 + x^4 + \cdots)}_{\text{collections of cats}}\\
     &\ \cdot \underbrace{(2^2x^2 + 2^3x^3 + 2^4x^4 + \cdots)}_{\text{lines of dogs}}\\
     & = \frac{x^2}{1 - x^2}\cdot (1+x) \cdot \frac{x^2}{1 - x} \cdot
        \frac{4x^2}{1-2x} \\
     & = \frac{x^2}{(1 - x)(1+x)}\cdot (1+x) \cdot \frac{x^2}{1 - x} \cdot
        \frac{4x^2}{1-2x}\\
     & =  \frac{4x^6}{(1 - x)^2(1-2x)}.
\end{align*}
\end{solution}


\ppart Find a simple formula for $P_n$.

\begin{solution}
$P_n$ is the coefficient of $x^n$ in the power series for $4x^6/(1 -
x)^2(1-2x)$, which means it is 4 times the coefficient of $x^{n-6}$ in the
series for $1/(1 -x)^2(1-2x)$ when $n \geq 6$, and $P_n = 0$ for $n<6$.

But we can express $1/(1 -x)^2(1-2x)$ using partial fractions as
\begin{equation}\label{ABC/}
\frac{1}{(1 -x)^2(1-2x)} = \frac{A}{1-x} + \frac{B}{(1-x)^2} + \frac{C}{1-2x}
\end{equation}
for some constants $A,B,C$, so $P_n$ will be 4 times the sum of the
coefficients of $x^{n-6}$ in each of $A/(1-x)$, $B/(1-x)^2$, and
$C/(1-2x)$, namely
\begin{equation}\label{PnABC}
P_n = 4(A+B\binom{n-5}{1} + C2^{n-6}) = 4A + 4B(n-5)+ C2^{n-4}.
\end{equation}

So we need only find the values of $A,B,C$.  But multiplying both sides
of~\eqref{ABC/} by the lefthand denominator $(1 -x)^2(1-2x)$ yields
\begin{equation}\label{ABCx}
1 = A(1-x)(1-2x) + B(1-2x) + C(1-x)^2.
\end{equation}
Now letting $x=1$ in ~\eqref{ABCx} gives $B=-1$.  Similarly, letting
$x=1/2$ gives $C=4$.  Finally, letting $x=0$ gives $A+B+C=1$ and so
$A=-2$.  Substituting these values into~\eqref{PnABC} finally gives
\[
P_n = 4(-2) - 4(n-5) + 4( 2^{n-4}) = 2^{n-2} - 4n + 12.
\]
\end{solution}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
