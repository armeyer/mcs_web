\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_relation_matrices}
  \pcomment{from: S02.cp3m}
\end{pcomments}

\pkeywords{
  relation
  matrix multiplication
  composition
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
There is a simple and useful way to extend \idx{composition} of
functions to composition of relations.  Namely, let $R: B\to C$ and
$S: A \to B$ be relations.  Then the \idx{composition} of $R$ with $S$
is the binary relation $(R \compose S): A\to C$ defined by the rule
\[
a \mrel{(R \compose S)} c \eqdef\ \exists b \in B.\, (b \mrel{R} c)
\QAND (a \mrel{S} b).
\]
This agrees with the Definition~\bref{func_compose_def} of composition
in the special case when $R$ and $S$ are functions.

We can represent a relation, $S$, between two sets $A =
\set{a_1,\dots,a_n}$ and $B = \set{b_1,\dots,b_m}$ as an
$n \times m$ matrix, $M_S$, of zeroes and ones, with the
elements of $M_S$ defined by the rule
\[
M_S (i, j)=1 \quad\QIFF\quad  a_i \mrel{S} b_j .
\] 

If we represent relations as matrices in this fashion, then we can
compute the composition of two relations $R$ and $S$ by a ``boolean''
matrix multiplication, $\otimes$, of their matrices.  Boolean matrix
multiplication is the same as matrix multiplication except that
addition is replaced by $\QOR$, multiplication is replaced by $\QAND$,
and 0 and 1 are used as the Boolean values \False\ and \True.
Namely, suppose $R: B \to C$ is a binary relation with $C =
\set{c_1,\dots,c_p}$.  So $M_R$ is an $m \times p$ matrix.  Then $M_S
\otimes M_R$ is an $n \times p$ matrix defined by the rule:
\begin{equation}\label{MSboolMR}
[M_S \otimes M_R](i,j) \eqdef \text{\large OR}_{k=1}^m [M_S(i,k) \QAND
  M_R(k,j)].
\end{equation}

Prove that the matrix representation, $M_{R\compose S}$, of $R
\compose S$ equals $M_S \otimes M_R$ (note the reversal of $R$ and
$S$).

\begin{solution}
\begin{proof}

We want to prove that
\begin{equation}\label{isrj}
i \mrel{(R\compose S)} j \quad\QIFF\quad [M_S \otimes M_R](i,j)=1.
\end{equation}

Now
\begin{align*}
\lefteqn{[M_S \otimes M_R](i,j) =1}\\
& \quad\QIFF \text{\large OR}_{k=1}^m [M_S(i,k) \QAND M_R(k,j)] =1
     & \text{(by~\eqref{MSboolMR})}\\
& \quad\QIFF [M_S(i,k) \QAND M_R(k,j)]=1 \text{ for some } k \in [1,m]
     & \text{(def. of $\QOR$)}\\
& \quad\QIFF [M_S(i,k) =1] \QAND [M_R(k,j)=1] \text{ for a } k \in [1,m]
     & \text{(def. of $\QAND$)}\\
& \quad\QIFF i \mrel{S} k\ \QAND\ k \mrel{R} j \text{ for some } k \in [1,m]
     & \text{(def. of $M_R, M_S$)}\\
& \quad\QIFF i (R \compose S) j
     & \text{(def. of $R \compose S$)}.
\end{align*}

\end{proof} 
\end{solution}

\end{problem}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
