\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_string_counting}
  \pcomment{by Rich 12/9/09}
  \pcomment{renamed from FP_dice_rolling}
\end{pcomments}

\pkeywords{
  combinatorics
  counting
  fair_coin
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}

%\textbf{Combinatorics and Counting}

\begin{editingnotes}
\ppart
Suppose that we are flipping a fair coin $n$ times. What is 
the probability that there are exactly $k$ heads, where the heads
must be separated by at least 2 tails?

\begin{solution}
  There are $\binom{n-2k+2}{k}$ number of ways to choose where to 
  place the heads (consider a bijection with having $k$ 1s 
  in an $n-2k+2$ bit binary string). Note that it is $n-2(k-1)$ 
  because the last head does not need to be followed by 2 tails.
  
  The total number of results is $2^n$, so the probability is:
  
  \[ \binom{n-2k+2}{k} \over {2^n} \]
\end{solution}

\ppart
\end{editingnotes}

An evil Teaching Assistant was trying to make a difficult probability
question for the Final.  The question went as follows:

``Suppose that you independently flip a fair coin $n \geq 5$ times.
What is the probability that there are at least $5$ consecutive heads?
For example, \texttt{THTTHHHHHT} and \texttt{HHHHHHHHH} describe
sequences of flips with 5 consecutive heads, but \texttt{HHHHTHHHHT}
does not.''

The Teaching Assistant then gave a solution that turned out to be
wrong:

\begin{bogusproof}
  Consider the possible results as a length $n$ string of \texttt{H}'s and
  \texttt{T}'s.  The total of all possible results is therefore $2^n$.

  We can then count the total number of strings that have $5$ consecutive
  \texttt{H}'s: there are $n - 4$ places to begin the length $5$ substring
  and $2^{n-5}$ ways to fill in the remaining $n-5$ bits.  There are,
  therefore, a total of $(n-4) \cdot 2^{n-5}$ possible strings.

  The probability is the number of results with $5$ consecutive
  \texttt{H}'s divided by the number of all possible results:
\begin{equation}\label{n416}
(n-4) \cdot \frac{2^{n-5}}{2^n} = \frac{n-4}{32}
\end{equation}
\end{bogusproof}

\bparts

\ppart[2] Give a counter-example to~\eqref{n416}.

\examspace[1.5in]
\begin{solution}
  For $n = 6$, there are only 3 strings with 5 consecutive \texttt{H}'s:
  $\mtt{H}^6, \mtt{TH}^5, \mtt{1}^5 \mtt{0}$, so the probability of
  getting 5 consecutive \texttt{H}'s is $3/64 \neq 1/8$.
\end{solution}

\ppart[3] Explain what the mistake is in the bogus proof.  You do
\emph{not} need to correct the proof or solve for the actual answer.

\examspace[2in]
\begin{solution}
  The mistake is in over-counting strings with more than 5 consecutive
  \texttt{H}'s.  For instance, for $n = 6$, the string \texttt{HHHHHH}
  will be counted in the case where the substring starts at the first
  \texttt{H} and again in the case where the substring starts at the
  second \texttt{H}.
\end{solution}

\eparts
\end{problem}

\endinput
