\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_non_unique_factoring}
  \pcomment{by ARM 10/29/11}
\end{pcomments}

\pkeywords{
  prime
  factorization
  unique
  complex_numbers
  norm
  irreducible
}

\def\sqmf{\sqrt{-5}}
\def\zmf{\integers[\sqmf]}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
The set of complex numbers that are equal to $m+n\sqmf$ for some
integers $m,n$ is called $\zmf$.  It will turn out that in $\zmf$, not
all numbers have \idx{unique factorizations}.

\iffalse
\begin{definition*}
$\zmf \eqdef \set{m+n\sqmf \suchthat m,n \in \integers}$
\end{definition*}
\fi

A sum or product of numbers in $\zmf$ is in $\zmf$, and since $\zmf$
is a subset of the complex numbers, all the usual rules for addition
and multiplication are true for it.  But some weird things do happen.
For example, the prime 29 has factors:

\bparts

\ppart Find $x, y \in \zmf$ such that $xy =29$ and $x \neq \pm 1 \neq
y$.

\begin{solution}
Let $x= (3 + 2\sqmf)$ and $y = (3 - 2\sqmf)$, so
\[
(3 + 2\sqmf)(3 - 2\sqmf) = 9 - \sqmf^2 \cdot 4 = 9 + 5 \cdot 4 = 29.
\]
\end{solution}

\eparts

On the other hand, the number 3 is still a ``prime'' even in $\zmf$.
More precisely, a number $p \in \zmf$ is called \term{irreducible}
over $\zmf$ iff when $xy=p$ for some $x,y \in \zmf$, either $x= \pm 1$
or $y = \pm 1$.

\begin{claim*}
The numbers $3, 2 + \sqmf$, and $2 - \sqmf$ are irreducible over
$\zmf$.
\end{claim*}

In particular, this Claim implies that the number 9 factors into
irreducibles over $\zmf$ in two different ways:
\begin{equation}\label{3292}
3 \cdot 3 = 9 = (2 + \sqmf) (2 - \sqmf).
\end{equation}
So $\zmf$ is an example of what is called a \term{non-unique
  factorization} domain.

To verify the Claim, we'll appeal (without proof) to a familiar
technical property of complex numbers given in the following Lemma.

\begin{definition*}
For a complex number $c = r+si$ where $r,s \in \reals$ and $i$ is
$\sqrt{-1}$, the \term{conjugate} of $c$ is the number $r-si$.
The \term{norm}, $\abs{c}$, of $c$ is $\sqrt{r^2 + s^2}$ which equals
the product $c\cdot c^*$ of $c$ and its conjugate, $c^*$.
\end{definition*}

\begin{lemma*}
For $c,d \in \complexes$,
\[
\abs{cd} = \abs{c} \abs{d}.
\]
\end{lemma*}

\iffalse

\begin{proof}
For $c=r_c+s_c i$, $d=r_d+s_d i$,
\begin{align*}
\abs{c}\abs{d}
     & = \sqrt{r_c^2+s_c^2} \sqrt{r_d^2+s_d^2}\\
     & = \sqrt{(r_c^2+s_c^2)(r_d^2+s_d^2)}\\
     & = \sqrt{r_c^2r_d^2 + (r_c^2s_d^2 + r_d^2s_c^2) + s_c^2s_d^2}\\
     & = \sqrt{(r_cr_d)^2 + (r_cs_d)^2 + (r_ds_c)^2 + (s_cs_d)^2}\\
     & = \sqrt{((r_cr_d)^2 -2r_cr_ds_cs_d + (s_cs_d)^2) +
                (r_ds_c)^2 +2r_cr_ds_cs_d + (r_cs_d)^2}\\
     & = \sqrt{(r_cr_d - s_cs_d)^2 + (r_ds_c + r_cs_d)^2}\\
     & = \abs{(r_cr_d - s_cs_d) + (r_ds_c + r_cs_d)i}\\
     & = \abs{(r_c+s_c i) (r_d+s_d i)}\\
     & = \abs{cd}
\end{align*}
\end{proof}
\fi

\bparts

\ppart\label{norm2not3} Prove that $\abs{x}^2 \neq 3$ for all $x \in
\zmf$.

\begin{solution}
Say $x = m + n\sqmf$ for $m,n \in \integers$.  Now suppose to the contrary
that $\abs{x}^2 \eqdef m^2 + 5n^2 = 3$.  But $m^2 + 5n^2 \geq 5$ for
$n \neq 0$.  Hence $n$ must be 0, in which case the integer $m$ must
be $\pm \sqrt{3}$, a contradiction.
\end{solution}

\ppart\label{xz5} Prove that if $x \in \zmf$ and $\abs{x}=1$, then $x
= \pm 1$.

\begin{solution}
\begin{proof}
Say $x = m + n\sqmf$ for $m,n \in \integers$.  So $\abs{x} = \sqrt{m^2
  + 5n^2}$.  But $m^2 +5n^2 > 1$ if $n \neq 0$, so $\abs{x} = 1$
implies $\sqrt{m^2}=1$.  That is, $x = m = \pm 1$.
\end{proof}
\end{solution}

\ppart\label{xy3pm1} Prove that if $\abs{xy} = 3$ for some $x,y \in
\zmf$, then $x=\pm 1$ or $y= \pm 1$.

\hint $\abs{zz^*} \in \naturals$ for $z \in \zmf$.

\begin{solution}
\begin{proof}
\begin{align*}
3 = \abs{xy} & \qimplies \abs{x}^2 \abs{y}^2 = \abs{xy}^2 = 3^2
         & \text{(by the Lemma)}\\
     & \qimplies \abs{x}^2 = 1 \QOR \abs{y}^2 = 1 \QOR \abs{x}^2 = \abs{y}^2 = 3\\
     & \hfill \text{(by the hint and unique factorization of $3^2$ over $\integers$)}\\
     & \qimplies \abs{x}^2 = 1 \QOR \abs{x}^2 = 3 \QOR \abs{y}^2 =1\\
     & \qimplies \abs{x}^2 = 1 \QOR \abs{y}^2 =1
           & \text{(by part~\eqref{norm2not3})}\\
     & \qimplies x = \pm 1 \QOR y = \pm 1
         & \text{(by part~\eqref{xz5})}
\end{align*}
\end{proof}
\end{solution}

\ppart  Complete the proof of the Claim.

\begin{solution}
We must prove that 3, and $2 \pm \sqmf$ are irreducible over $\zmf$.
That is, suppose $xy =3$, or $xy = 2 \pm \sqmf$, for some $x, y \in
\zmf$.  We must prove that either $x= \pm 1$ or $y = \pm 1$.

But by definition,
\[
\abs{2 \pm \sqmf} = \sqrt{2^2 + 5\cdot 1^2} = \sqrt{9} = 3 = \abs{3}.
\]
So $\abs{xy} = 3$ in any case, and part~\eqref{xy3pm1}
implies $x= \pm 1$ or $y = \pm 1$, as required.
\end{solution}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\endinput
