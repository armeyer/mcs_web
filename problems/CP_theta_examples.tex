\documentclass[problem]{mcs}

\begin{pcomments}
 \pcomment{CP_theta_examples}
 \pcomment{from S07.ps8}
\end{pcomments}

\pkeywords{
 Theta
 asymptotic
 Stirling
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Determine which of these choices 
\[
\Theta(n), \quad
\Theta(n^2 \log n), \quad
\Theta(n^2), \quad
\Theta(1), \quad
\Theta(2^n), \quad
\Theta(2^{n \ln n}), \quad
\text{none of these}
\]
describes each function's asymptotic behavior.  Full proofs are not
required, but briefly explain your answers.

\bparts
\ppart  
\[
n + \ln n + (\ln n)^2
\]

\begin{solution}
Both $n > \ln n$ and $n > (\ln n)^2$ hold for all
sufficiently large $n$.  Thus, for all sufficiently large $n$:
\[
n < n + \ln n + (\ln n)^2 < n + n + n
\]
So $n + \ln n + (\ln n)^2 = \Theta(n)$.

\end{solution}

\ppart 
\[
\frac{n^2 + 2n - 3}{n^2 - 7}
\]

\begin{solution}

Observe that:
\[
\lim_{n \to \infty} \frac{n^2 + 2n - 3}{n^2 - 7} = 1
\]
This means that, for all sufficiently large $n$, the fraction lies, for
example, between $0.99$ and $1.01$ and is therefore $\Theta(1)$.
\end{solution}

\ppart 
\[
\sum_{i = 0}^n 2^{2i+1}
\]

\begin{solution}
Geometric sums are dominated by their largest term, which is
$2^{2n+1} = 2 \cdot 4^n$.  This is $\Theta(4^n)$, which does not
appear in the list provided.
\end{solution}

\ppart 
\[
\ln (n^2!)
\]

\begin{solution}

By Stirling's formula:
\[
n^2! \sim \sqrt{2 \pi n^2} \left(\frac{n^2}{e}\right)^{n^2}
\]
Taking logarithms gives:
%
\begin{align*}
\ln(n^2!)
    & \sim \ln(\sqrt{2 \pi n^2} \left(\frac{n^2}{e}\right)^{n^2}) \\
    & = \ln(\sqrt{2 \pi n^2}) + \ln\left(\frac{n^2}{e}\right)^{n^2} \\
    & = \frac{1}{2}\ln 2\pi + \ln n + n^2 \ln (\frac{n^2}{e}) \\
    & = \frac{1}{2}\ln 2\pi + \ln n + n^2(2 \ln n - 1)
\end{align*}
%
It is then easy to see that this expression and $n^2 \ln n$ are big-O of each other by looking at limits as $n$ goes to $\infty$, so we conclude that $\ln (n^2!) = \Theta(n^2 \ln n)$.
%\begin{align*}
%\ln(n^2!)
%    & \sim \ln(\sqrt{2 \pi n^2} \left(\frac{n^2}{e}\right)^{n^2}) \\
%    & = \ln(\sqrt{2 \pi n^2}) + \ln\left(\frac{n^2}{e}\right)^{n^2}
%\end{align*}
%%
%The first term is tiny compared to the second, which we can rewrite as:
%%
%\[
%\ln\left(\frac{n^2}{e}\right)^{n^2}
%     = n^2 \ln\left(\frac{n^2}{e}\right) = \Theta(n^2 \ln n)
%\]

\end{solution}

\ppart
\[
\sum_{k=1}^{n} k \left(1 - \frac{1}{2^k}\right)
\]

\begin{solution}
The expression in parentheses is always at least $1/2$ and
at most $1$.  Thus, we have the bounds:
%
\[
\frac{1}{2} \sum_{k=1}^{n} k
\leq
\sum_{k=1}^{n} k \left(1 - \frac{1}{2^k}\right)
\leq
\sum_{k=1}^{n} k
\]
%
Since the first expression and the last are both $\Theta(n^2)$, so is
the one in the middle.
\end{solution}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
