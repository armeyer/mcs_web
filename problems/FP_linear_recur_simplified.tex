\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{Taken from FP_linear_recur}
  \pcomment{slightly more complex version of MQ_gen_2}
  \pcomment{renamed from MQ_gen_3}
  \pcomment{soln edited ARM 4/28/12}
\end{pcomments}

\pkeywords{
  recurrence
  linear_recurrence
  generating_function
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Express the generating function $R(x) \eqdef \sum_0^\infty
r_nx^n$ as a quotient of polynomials or products of polynomials, where $r_n$ is defined as

\[r_n = \begin{cases}
           7r_{n-1}  +  4r_{n-2}  + (n+1) & \text{for } n\geq 2,\\
           0                           &  \text{for } n < 2.
       \end{cases}
\]

You do \emph{not} have to find a closed form for $r_n$.

\begin{solution}
Using the formula~(\bref{c-alpha-k-coeff}) for the coefficient of $(1-x)^{-2}$, we have
\[
\begin{array}{rcrcrcrcrcl}
R(x)      & = & r_0 & + & r_1  x & + &  r_2 x^2 & + & r_3 x^3  & + & \cdots\\
-7xR(x)   & = &     & - & 7r_0 x & - & 7r_1 x^2 & - & 7r_2 x^3 & - & \cdots\\
-4x^2R(x) & = &     &   &        & - & 4r_0 x^2 & - & 4r_1 x^3 & - & \cdots\\
-(1-x)^{-2}& = &  -1 & - &    2 x & - &    3 x^2 & - &   4 x^3 & - & \cdots\\
\hline
         & = & r_0-1& + & (r_1 - 7r_0 -2)
                               x & + &    0 x^2 & + &    0x^3 & + &  \cdots\\
         & = &  -1  & + &  -2  x & + &    0 x^2 & + &    0x^3 & + &  \cdots .
\end{array}
\]
Therefore,
\[
R(x)(1-7x-4x^2) -\frac{1}{(1-x)^2} = -(1 + 2x),
\]
\iffalse
Therefore,
\begin{align*}
R(x)(1-7x-4x^2)
 & = \frac{1}{(1-x)^2} - (1 + 2x)\\
 & = \frac{1- (1+2x)(1-x)^2}{(1-x)^2}\\
 & = \frac{x^2(3+2x)}{(1-x)^2},
\end{align*}
\fi
so
\[
R(x) = \frac{x^2(3+2x)}{(1-7x-4x^2)(1-x)^2}\ .
\]

\end{solution}

\end{problem}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\endinput
