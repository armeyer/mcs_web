\documentclass[problem]{mcs}

\begin{pcomments}
    \pcomment{RSA_reversed}
    \pcomment{draft by David Shi, rewritten by ARM 10/11/11}
\end{pcomments}

\pkeywords{
  RSA
  encryption
}

\begin{problem}

Using the RSA encryption system, Pete the \emph{p}ublisher generates a
private key $(d,n)$ and posts a public key, $(e,n)$, which anyone can
use to send encrypted messages to Pete.

RSA has the useful property that these same keys can switch roles: if
Pete wants to broadcast an unforgeable ``signed'' message, he can
encrypt his message using his private key as though it was someone's
public key.  That is, from a plain text $m \in [0,n)$, Pete would
  broadcast a ``signed'' version, $s \eqdef \rem{m^d}{n}$.

Then anyone can decrypt and read Pete's broadcast message
by using Pete's public key as though it were their own private key.
Readers of Pete's message can be sure the message came from Pete if
they believe that the only way to generate such a message is by using
the private key which Pete alone knows.  (This belief is widely
accepted, but not certain.)
\bparts

\ppart\label{sfromm} Explain exactly what calculation must be
performed on $s$ to recover $m$ using the public key $(e,n)$.

\begin{solution}
\[
m = \rem{s^e}{n}.
\]
\end{solution}

\ppart Explain why the calculation of part~\eqref{sfromm} yields the
plain text $m$.

\begin{solution}
We write ``$\equiv$'' for  ``$\equiv p\; mod \; n$:''
\begin{align*}
s^e & \equiv (m^d)^e & \text{($s \equiv m^d$ by def)}\\
    & \equiv  m^{de} & ((m^d)^e = m^{de})\\
    & \equiv m^1 \equiv m
        & \text{by Euler's theorem since $de \equiv 1 \phi(n)$}
\end{align*}    
Since $m \in [0,n)$, it follows that $m = \rem{s^e}{n}$.
\end{solution}

\eparts


\end{problem}

\endinput

\iffalse

\bparts

Consider communication between server Sierra and client Charlie where
Sierra generates the public key $(e,n)$ and the private key $(d,n)$ for RSA.
When Charlie wants to send Sierra a message $m$ secretly,
Charlie can send the encrypted message $m^*=\rem{m^{e}}{n}$ to Sierra.
Sierra can reproduce $m$ from $m^*$ by computing $m=\rem{m^{*d}}{n}$ and
no one else can read $m^*$ because they do not know the private key.
However, since the public key is known to everyone,
a third party opponent Oscar can pretend to be Charlie 
and send Sierra a message encrypted by the public key.
In this problem we will see RSA can also prevent forged messages 
when the keys are used in reverse.

\ppart
Using the same keys Sierra had generated for RSA,
consider when Sierra wants to send Charlie a message $m$.
Sierra can encrypts $m$ using the private key $(d, n)$ to produce
$m^*=\rem{m^{d}}{n}$ and sends $m^*$ to Charlie.
Explain how Charlie can reproduce the original message $m$
with only $m^*$ and $(e,n)$ and why this method will return $m$.

\begin{solution}
Charlie can reproduce $m$ by computing $m=\rem{m^{*e}}{n}$. 
Since the normal RSA scheme decrypts messages using the property
$\rem{\rem{m^{e}}{n}^d}{n} = \rem{m^{ed}}{n} = m$,
with the keys reversed, the message can still be decrypted because that
$\rem{\rem{m^{d}}{n}^e}{n} = \rem{m^{de}}{n} = m$.
\end{solution}

\ppart
%n = p * q = 29 * 37 = 1073 
%phi(n) = 28 * 26 = 1008
%e,d = 605,5 
Given the public key (5, 1073), and the encrypted message 33, 
what is the original message?

\begin{solution}
The original message is $\rem{33^5}{1073} = 937$
\end{solution}

Charlie can be confident that $m$ came from Sierra because the message
is encrpyted with the private key which only Sierra knows.

%\ppart
%Explain in words why $B$ can be confident that this message is not forged?
%
%\begin{solution}
%Because only $A$ knows the private key.
%\end{solution}

\eparts
\fi
