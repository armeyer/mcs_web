\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_squares_modp}
  \pcomment{from: F14.ps3}
\end{pcomments}

\pkeywords{
  number_theory
  modular_arithmetic
  primes
  square
  square_root
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
This problem is about finding square roots modulo a prime $p$.

\bparts

\ppart\label{x2y2pm1} Prove that $x^2 \equiv y^2 \pmod p$ if and only
if $x \equiv y \pmod p$ or $x \equiv -y \pmod p$.  \hint{$x^2-y^2 =
  (x+y)(x-y)$}

\begin{solution}
$x^2 \equiv y^2 \pmod p$ iff $p \mid x^2-y^2$.  But $x^2-y^2 =
  (x-y)(x+y)$, and since $p$ is a prime, this happens iff either $p
  \mid x-y$ or $p \mid x+y$, which is iff $x \equiv y \pmod p$ or $x
  \equiv -y \pmod p$.
\end{solution}
\eparts

An integer $x$ is called a \term{square root} of $n$ mod $p$ when
\[
x^2 \equiv n \pmod p.
\]
An integer with a square root is called a \emph{square} mod $p$.  For example, if $n$
is congruent to 0 or 1 mod $p$, then $n$ is a square and it is it's own square root.

So let's assume that $p$ is an odd prime and $n \not\equiv 0 \pmod p$.
It turns out there is a simple test we can perform to see if $n$ is a
square mod $p$:

\begin{center}
\textbf{Euler's Criterion}
\end{center}
\begin{romanlist}
\item If $n$ is a square modulo $p$, then $n^{(p-1)/2} \equiv 1 \pmod p$.\label{ECI1}

\item If $n$ is not a square modulo $p$ then $n^{(p-1)/2} \equiv -1 \pmod p$.\label{ECI2}
\end{romanlist}


\bparts

\ppart Prove case~\ref{ECI1} of Euler's Criterion. \hint{Use Fermat's theorem.}

\begin{solution}
If $x$ is a square root of $n$ mod $p$, then 
\begin{align*}
n^{(p-1)/2}
  & \equiv (x^2)^{(p-1)/2} \pmod p\\
  & = x^{p-1} \equiv 1 \pmod p & \text{by Fermat's theorem.}
\end{align*}

\end{solution}

\ppart Prove case~\ref{ECI2} of Euler's Criterion. \hint{Use
  part~\eqref{x2y2pm1}}

\begin{solution}
Let
\[
y \eqdef n^{(p-1)/2}.
\]
We want to prove that if $n$ is not a square mod $p$, then $y \equiv
-1 \pmod p$.

Now
\begin{align*}
y^2 & \equiv \paren{n^{(p-1)/2}}^2\\
    & = n^{p-1}\\
    & \equiv 1 \pmod p & \text{by Fermat's theorem.}
\end{align*}
Part~\eqref{x2y2pm1} now implies that $y \equiv \pm 1 \pmod p$.  But
if $y \equiv 1 \pmod p$, then Euler's Criterion~\ref{ECI1} would imply
that $n$ was a square mod $p$, so the only possibility is that $y
\equiv -1 \pmod p$.
\end{solution}

\ppart Suppose that $p \equiv 3 \pmod 4$, and $n$ is a square mod $p$.
Find a simple expression in terms of $n$ and $p$ for a square root of
$n$.  \hint{Write $p$ as $p=4k+3$ and use Euler's Criterion. You might
  have to multiply two sides of an equation by $n$ at one point.}

\begin{solution}  We know that $p=4k+3$ for some positive integer $k$.  Now we
claim that $x \eqdef n^{k+1}$ is a square root of $n$.

To prove this, notice that $(p-1)/2 = 2k+1$.  Since $n$ is a square
mod $p$, we have by Euler's Criterion~\ref{ECI1} that
\[
n^{2k+1} = n^{(p-1)/2} \equiv 1 \pmod p.
\]
Multiplying both sides by $n$, we get
\begin{equation}\label{n2k+1n}
n^{2k+1}n \equiv 1\cdot n  = n \pmod p.
\end{equation}
But 
\[
x^2 = \paren{n^{k+1}}^2 = n^{2k+1}n,
\]
so~\eqref{n2k+1n} implies that $x^2 \equiv n \pmod p$ as claimed.
\end{solution}

\eparts

\end{problem}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
