\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_gambler_derivation}
  \pcomment{from: F05.cp15w}
\end{pcomments}

\pkeywords{
  probability
  expectation
  random_walk
  gamblers_ruin
  linear-recurrence
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}

A gambler aims to gamble until he reaches a \emph{goal} of $T$ dollars or
until he runs out of money, in which case he is said to be ``ruined.''  He
gambles by making a sequence of 1 dollar bets.  If he wins an individual
bet, his stake increases by one dollar.  If he loses, his stake decreases
by one dollar.  In each bet, he wins with probability $p>0$ and loses with
probability $q \eqdef 1-p >0$.  He is an overall {\em winner} if he
reaches his goal and is an overall \emph{loser} if he gets ruined.

In a \emph{fair} game, $p = q = 1/2$.  The gambler is more likely to win
if $p>1/2$ and less likely to win if $p<1/2$.

With $T$ and $p$ fixed, the gambler's probability of winning will depend
on how much money he starts with.  Let $w_n$ be the probability that he is
a winner when his initial stake in $n$ dollars.

\begin{problemparts}

\problempart  What are $w_0$ and $w_T$?

\begin{solution}
$w_0 = 0$ and $w_T=1$.
\end{solution}

\problempart Note that $w_n$ satisfies a linear recurrence
\begin{equation}\label{recab}
w_{n+1} = aw_{n}+bw_{n-1}
\end{equation}
for some constants $a,b$ and $0 < n < T$.  Write simple expressions for
$a$ and $b$ in terms of $p$.

\begin{solution}
By Total Probability
\begin{align}
w_n & = \prcond{\text{win game}}{\text{win the first bet}}\pr{\text{win the first
   bet}} +\\
    & \quad \prcond{\text{win game}}{\text{lose the first bet}}\pr{\text{lose the first bet}}\notag\\
   & = pw_{n+1}+q\pr{w_{n-1}}, & \text{so}\notag\\
pw_{n+1} & = w_n - qw_{n-1}\notag\\
w_{n+1} & = \frac{w_n}{p} - \frac{qw_{n-1}}{p}.\label{wrec}
\end{align}
So
\[
a = \frac{1}{p}, \qquad b= - \frac{q}{p}.
\]
\end{solution}

\problempart For $n>T$, let $w_n$ be defined by the recurrence~\eqref{recab},
and let $g(x) \eqdef \sum_{n=1}^\infty w_nx^n$ be the generating function
for the sequence $w_0,w_1,\dots$.  Verify that
\begin{equation}\label{gx}
g(x) = \frac{w_1 x}{(1-x)(1-\dfrac{q}{p}x)}.
\end{equation}

\begin{solution}
\[\begin{array}{rclclclclc}
g(x)          & = & w_0 & + & w_1x   & + & w_2x^2       & + & w_3x^3       & + \cdots\\
xg(x)/p       & = &     &   & w_0x/p & + & w_1x^2/p     & + & w_2x^3/p     & + \cdots\\
(q/p)x^2g(x) & = &     &   &        &    & (q/p)w_0x^2  & + & (q/p)w_1x^3 & + \cdots
\end{array}\]
so
\begin{align}
g(x) - \paren{\frac{xg(x)}{p} - \frac{qx^2g(x)}{p}} & = w_0 + w_1x - w_0 x/p =
w_1x,\notag\\
g(x)\paren{ 1 - \frac{x}{p} + \frac{qx^2}{p}} & = w_1 x.\label{gfw}
\end{align}
But
\begin{equation}\label{fac}
1 - \frac{x}{p} + \frac{qx^2}{p} = (1-x)(1-\frac{q}{p}x)
\end{equation}
Combining~\eqref{fac} and~\eqref{gfw} yields~\eqref{gx}.
\end{solution}

\problempart Conclude that in an unfair game
\begin{equation}\label{wncd}
w_n = c+d\paren{\frac{q}{p}}^n
\end{equation}
for some constants $c,d$.

\begin{solution}
In an unfair game $p/q \neq 1$, so from~\eqref{gx}, we know that there
will be $c,d$ such that
\begin{equation}\label{cd}
g(x) = \frac{c}{1-x} + \frac{d}{1-\dfrac{q}{p}x}
\end{equation}
so $w_n$ will be the corresponding combination of the coefficients of
$x^n$ in $1/(1-x)$ and $1/(1- (q/p)x)$, namely,~\eqref{wncd}.
\end{solution}

\problempart  Show that in an unfair game,
\[
w_n=\frac{(q/p)^n-1}{(q/p)^T-1}.
\]


\begin{solution}
Given~\eqref{gx}, we want $c,d$ such that
\[
\frac{w_1 x}{(1-x)(1-\dfrac{q}{p}x)} = \frac{c}{1-x} +
\frac{d}{1-\dfrac{q}{p}x}.
\]
So $c,d$ satisfy
\[
w_1 x = c(1-\frac{q}{p}x) + d(1-x).
\]

Letting $x= 1$ gives
\[
c= \frac{w_1}{1-q/p}.% = \frac{pw_1}{2p-1}.
\]
Letting $x= p/q$ gives
\[
d= \frac{pw_1/q}{1-p/q} = \frac{w_1}{q/p-1}= - c.
\]
So plugging into~\eqref{wncd} gives
\begin{equation}\label{wnd}
w_n = \frac{w_1}{q/p-1} \paren{\paren{\frac{q}{p}}^n -1}.
\end{equation}
Now we can solve for $w_1$, by letting $n=T$ in~\eqref{wnd}:
\[
1=w_T = \frac{w_1}{q/p-1} \paren{\paren{\frac{q}{p}}^T -1}
\]
so
\[
w_1 = \frac{\paren{q/p -1}}{\paren{q/p}^T - 1}.
\]
Combining this with~\eqref{wnd} yields
\[
w_n = \frac{\paren{\paren{q/p}^n -1}}{\paren{q/p}^T -1}.
\]
\end{solution}

\problempart Verify that if $0 < a < b$, then
\[
\frac{a}{b} < \frac{a+1}{b+1}.
\]
Conclude that if $p < 1/2$, then
\[
w_n < \paren{\frac{p}{q}}^{T-n}.
\]

\begin{solution}
\[
\frac{a}{b} = \frac{a(1+1/b)}{b(1+1/b)} = \frac{a+a/b}{b+1} < \frac{a+1}{b+1}.
\]
So from the previous part, we have
\[
w_n=\frac{(q/p)^n-1}{(q/p)^T-1} < \frac{(q/p)^n}{(q/p)^T} =
\paren{\frac{q}{p}}^{n-T} = \paren{\frac{p}{q}}^{T-n}.
\]
\end{solution}

\problempart Show that in a fair game,
\[
w_n = \frac{w}{T}.
\]
\hint Use equation~\eqref{gx} again.

\begin{solution}
This time $p=q=1/2$ so from~\eqref{gx},
\[
g(x) = \frac{w_1 x}{(1-x)^2}.
\]
Now we need $a,b$ such that
\begin{equation}\label{abfair}
\frac{w_1 x}{(1-x)^2} = \frac{a}{1-x} + \frac{b}{(1-x)^2},
\end{equation}
so we will have
\[
w_n = a+b(n+1).
\]

Solving for $a,b$, we have from~\eqref{abfair}
\[
w_1 x = a(1-x) + b.
\]
Letting $x=0$ yields $a=-b$ and $x=1$ yields $b=w_1$,
so
\[
w_n = -w_1 + w_1(n+1) = w_1 n.
\]
Also,
\[
1 = w_T = w_1 T
\]
so
\[
w_1 = \frac{1}{T}
\]
and hence
\[
w_n = \frac{n}{T}.
\]
\end{solution}

\end{problemparts}

\end{problem}


\endinput
